var B=c=>{throw TypeError(c)};var U=(c,h,u)=>h.has(c)||B("Cannot "+u);var t=(c,h,u)=>(U(c,h,"read from private field"),u?u.call(c):h.get(c)),f=(c,h,u)=>h.has(c)?B("Cannot add the same private member more than once"):h instanceof WeakSet?h.add(c):h.set(c,u),d=(c,h,u,O)=>(U(c,h,"write to private field"),O?O.call(c,u):h.set(c,u),u),k=(c,h,u)=>(U(c,h,"access private method"),u);(async()=>{var I,l,m,w,y,b,_,A,M,L,T,$,S,x,P;(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();const c="modulepreload",h=function(o){return"/JOSH/"+o},u={},O=function(o,e,s){let r=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.allSettled(e.map(g=>{if(g=h(g),g in u)return;u[g]=!0;const H=g.endsWith(".css"),Z=H?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${Z}`))return;const E=document.createElement("link");if(E.rel=H?"stylesheet":c,H||(E.as="script"),E.crossOrigin="",E.href=g,a&&E.setAttribute("nonce",a),document.head.appendChild(E),H)return new Promise((ee,te)=>{E.addEventListener("load",ee),E.addEventListener("error",()=>te(new Error(`Unable to preload CSS for ${g}`)))})}))}function n(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return r.then(i=>{for(const a of i||[])a.status==="rejected"&&n(a.reason);return o().catch(n)})};let C=null,q=null;async function D(){return(await O(async()=>{const{default:o}=await import("./re_viewer-BA9PaZRE.js");return{default:o}},[])).default}async function R(){return fetch(new URL("/JOSH/assets/re_viewer_bg-D3lypzTS.wasm",import.meta.url))}async function W(){(!C||!q)&&([C,q]=await Promise.all([D(),WebAssembly.compileStreaming(R())]));let o=C();return await o(q),class extends o.WebHandle{free(){super.free(),o.deinit()}}}let v=null;function J(){const o=new Uint8Array(16);return crypto.getRandomValues(o),Array.from(o).map(e=>e.toString(16).padStart(2,"0")).join("")}function V(o){return new Promise(e=>setTimeout(e,o))}class j{constructor(){f(this,A);f(this,I,J());f(this,l,null);f(this,m,null);f(this,w,"stopped");f(this,y,!1);f(this,b,!1);f(this,_,new Map);f(this,L,()=>{});f(this,T,()=>{v==null||v();const e=t(this,m),s=e.getBoundingClientRect(),r=()=>{e.style.left=s.left+"px",e.style.top=s.top+"px",e.style.width=s.width+"px",e.style.height=s.height+"px"},n=()=>e.removeAttribute("style"),i=a=>setTimeout(()=>requestAnimationFrame(a),N);e.classList.add(p.fullscreen_base,p.fullscreen_rect),r(),requestAnimationFrame(()=>{t(this,y)&&(e.classList.add(p.transition),i(()=>{t(this,y)&&(n(),document.body.classList.add(p.hide_scrollbars),document.documentElement.classList.add(p.hide_scrollbars),k(this,A,M).call(this,"fullscreen",!0))}))}),d(this,L,()=>{document.body.classList.remove(p.hide_scrollbars),document.documentElement.classList.remove(p.hide_scrollbars),r(),e.classList.remove(p.fullscreen_rect),i(()=>{t(this,y)||(n(),e.classList.remove(p.fullscreen_base,p.transition))}),v=null,d(this,y,!1),k(this,A,M).call(this,"fullscreen",!1)}),v=()=>t(this,L).call(this),d(this,y,!0)});K(),G()}async start(e,s,r){if(s??(s=document.body),r??(r={}),d(this,b,r.allow_fullscreen||!1),t(this,w)!=="stopped")return;d(this,w,"starting"),d(this,m,document.createElement("canvas")),t(this,m).style.width=r.width??"640px",t(this,m).style.height=r.height??"360px",s.append(t(this,m)),await V(0);let n=await W();if(t(this,w)!=="starting")return;const i=t(this,b)?{get_state:()=>t(this,y),on_toggle:()=>this.toggle_fullscreen()}:void 0;d(this,l,new n({...r,fullscreen:i}));try{await t(this,l).start(t(this,m))}catch(a){throw this.stop(),a}t(this,w)==="starting"&&(d(this,w,"ready"),k(this,A,M).call(this,"ready"),e&&this.open(e))}on(e,s){const r=t(this,_).get(e)??new Map;return r.set(s,{once:!1}),t(this,_).set(e,r),()=>r.delete(s)}once(e,s){const r=t(this,_).get(e)??new Map;return r.set(s,{once:!0}),t(this,_).set(e,r),()=>r.delete(s)}off(e,s){const r=t(this,_).get(e);r?r.delete(s):console.warn("Attempted to call `WebViewer.off` with an unregistered callback. Are you passing in the same function instance?")}get canvas(){return t(this,m)}get ready(){return t(this,w)==="ready"}open(e,s={}){if(!t(this,l))throw new Error(`attempted to open \`${e}\` in a stopped viewer`);const r=Array.isArray(e)?e:[e];for(const n of r)try{t(this,l).add_receiver(n,s.follow_if_http)}catch(i){throw this.stop(),i}}close(e){if(!t(this,l))throw new Error(`attempted to close \`${e}\` in a stopped viewer`);const s=Array.isArray(e)?e:[e];for(const r of s)try{t(this,l).remove_receiver(r)}catch(n){throw this.stop(),n}}stop(){var e,s,r;if(t(this,w)!=="stopped"){t(this,b)&&t(this,m)&&t(this,y)&&t(this,L).call(this),d(this,w,"stopped"),(e=t(this,m))==null||e.remove();try{(s=t(this,l))==null||s.destroy(),(r=t(this,l))==null||r.free()}catch(n){throw d(this,l,null),n}d(this,m,null),d(this,l,null),d(this,y,!1),d(this,b,!1)}}open_channel(e="rerun-io/web-viewer"){if(!t(this,l))throw new Error(`attempted to open channel "${e}" in a stopped web viewer`);const s=crypto.randomUUID();try{t(this,l).open_channel(s,e)}catch(a){throw this.stop(),a}const r=a=>{if(!t(this,l))throw new Error(`attempted to send data through channel "${e}" to a stopped web viewer`);try{t(this,l).send_rrd_to_channel(s,a)}catch(g){throw this.stop(),g}},n=()=>{if(!t(this,l))throw new Error(`attempted to send data through channel "${e}" to a stopped web viewer`);try{t(this,l).close_channel(s)}catch(a){throw this.stop(),a}},i=()=>t(this,w);return new z(r,n,i)}override_panel_state(e,s){if(!t(this,l))throw new Error(`attempted to set ${e} panel to ${s} in a stopped web viewer`);try{t(this,l).override_panel_state(e,s)}catch(r){throw this.stop(),r}}toggle_panel_overrides(e){if(!t(this,l))throw new Error("attempted to toggle panel overrides in a stopped web viewer");try{t(this,l).toggle_panel_overrides(e)}catch(s){throw this.stop(),s}}toggle_fullscreen(){if(t(this,b)){if(!t(this,l)||!t(this,m))throw new Error("attempted to toggle fullscreen mode in a stopped web viewer");t(this,y)?t(this,L).call(this):t(this,T).call(this)}}}I=new WeakMap,l=new WeakMap,m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,_=new WeakMap,A=new WeakSet,M=function(e,s){setTimeout(()=>{const r=t(this,_).get(e);if(r)for(const[n,{once:i}]of[...r.entries()])n(s),i&&r.delete(n)},0)},L=new WeakMap,T=new WeakMap;class z{constructor(e,s,r){f(this,$);f(this,S);f(this,x);f(this,P,!1);d(this,$,e),d(this,S,s),d(this,x,r)}get ready(){return!t(this,P)&&t(this,x).call(this)==="ready"}send_rrd(e){this.ready&&t(this,$).call(this,e)}close(){this.ready&&(t(this,S).call(this),d(this,P,!0))}}$=new WeakMap,S=new WeakMap,x=new WeakMap,P=new WeakMap;const p={hide_scrollbars:"rerun-viewer-hide-scrollbars",fullscreen_base:"rerun-viewer-fullscreen-base",fullscreen_rect:"rerun-viewer-fullscreen-rect",transition:"rerun-viewer-transition"},N=100,F=`
  html.${p.hide_scrollbars},
  body.${p.hide_scrollbars} {
    scrollbar-gutter: auto !important;
    overflow: hidden !important;
  }

  .${p.fullscreen_base} {
    position: fixed;
    z-index: 99999;
  }

  .${p.transition} {
    transition: all ${N/1e3}s linear;
  }

  .${p.fullscreen_rect} {
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
  }
`;function K(){const o="__rerun_viewer_style";if(document.getElementById(o))return;const e=document.createElement("style");e.id=o,e.appendChild(document.createTextNode(F)),document.head.appendChild(e)}function G(){window.addEventListener("keyup",o=>{o.code==="Escape"&&(v==null||v())})}const Q="https://raw.githubusercontent.com/genforce/JOSH/main/recordings/demo_1.rrd",X=document.getElementById("demo1"),Y=new j;window.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[autofocus]").forEach(e=>{e.removeAttribute("autofocus")});const o=HTMLElement.prototype.focus;HTMLElement.prototype.focus=function(e){this.classList.contains("allow-focus")&&o.call(this,e)}}),await Y.start(Q,X,{render_backend:"webgl",hide_welcome_screen:!0,panel_state_overrides:{top:"Hidden",blueprint:"Hidden"}})})();
